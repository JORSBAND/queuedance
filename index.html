<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ì—Ä–∞—Ñ—ñ–∫ —Ä–µ–ø–µ—Ç–∏—Ü—ñ–π</title>
    <!-- Tailwind CSS –¥–ª—è —Å—Ç–∏–ª—ñ–≤ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React —Ç–∞ ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <!-- Babel –¥–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó JSX –≤ –±—Ä–∞—É–∑–µ—Ä—ñ -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slide-up { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        body { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans pb-10">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        // –Ü–º–ø–æ—Ä—Ç–∏ Firebase –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ —á–µ—Ä–µ–∑ CDN (–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π —Å–ø–æ—Å—ñ–± –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, addDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const { useState, useEffect, useMemo } = React;

        // --- –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Firebase ---
        const firebaseConfig = {
            apiKey: "AIzaSyCm8nZvhps4yeYDzPNyKLI_PvadAOeYI20",
            authDomain: "vhrchat.firebaseapp.com",
            projectId: "vhrchat",
            storageBucket: "vhrchat.firebasestorage.app",
            messagingSenderId: "1039293838718",
            appId: "1:1039293838718:web:b74fddda402267040bef2f",
            measurementId: "G-R9XY6JRZMF"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // –®–ª—è—Ö –¥–æ –∫–æ–ª–µ–∫—Ü—ñ—ó –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö (–ø—Ä–æ—Å—Ç–∏–π —à–ª—è—Ö –¥–ª—è —Ç–≤–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥—É)
        const COLLECTION_NAME = 'rehearsals';

        // --- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ ---
        const CLASSES = ["5–ê", "5–ë", "5–í", "6–ê", "6–ë", "7–ê", "7–ë"];
        const HALLS = [
            { id: 'choreography', name: '–•–æ—Ä–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–π' },
            { id: 'assembly', name: '–ê–∫—Ç–æ–≤–∏–π' }
        ];
        const DANCE_TYPES = [
            { id: 'waltz', name: '–í–∞–ª—å—Å' },
            { id: 'general', name: '–ó–∞–≥–∞–ª—å–Ω–∏–π —Ç–∞–Ω–µ—Ü—å' }
        ];
        const DAYS = [
            { id: 1, name: '–ü–æ–Ω–µ–¥—ñ–ª–æ–∫', short: '–ü–ù' },
            { id: 2, name: '–í—ñ–≤—Ç–æ—Ä–æ–∫', short: '–í–¢' },
            { id: 3, name: '–°–µ—Ä–µ–¥–∞', short: '–°–†' },
            { id: 4, name: '–ß–µ—Ç–≤–µ—Ä', short: '–ß–¢' },
            { id: 5, name: '–ü\'—è—Ç–Ω–∏—Ü—è', short: '–ü–¢' }
        ];
        const ADMIN_PASSWORD = "44442222";

        // --- –Ü–∫–æ–Ω–∫–∏ SVG ---
        const IconUser = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;
        const IconMapPin = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>;
        const IconTrash = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>;
        const IconPlus = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const IconInfo = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>;
        const IconShield = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>;

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ç–∏–∂–Ω—è (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ—á–∏—â–µ–Ω–Ω—è)
        const getCurrentWeekKey = () => {
            const d = new Date();
            d.setHours(0, 0, 0, 0);
            d.setDate(d.getDate() + 3 - (d.getDay() + 6) % 7);
            const week1 = new Date(d.getFullYear(), 0, 4);
            const weekNumber = 1 + Math.round(((d.getTime() - week1.getTime()) / 86400000 - 3 + (week1.getDay() + 6) % 7) / 7);
            return `${d.getFullYear()}-W${weekNumber}`;
        };

        function App() {
            const [user, setUser] = useState(null);
            const [profile, setProfile] = useState(null);
            const [isAdmin, setIsAdmin] = useState(() => localStorage.getItem('rehearsals_admin') === 'true');
            const [rehearsals, setRehearsals] = useState([]);
            
            const [selectedDay, setSelectedDay] = useState(new Date().getDay() >= 1 && new Date().getDay() <= 5 ? new Date().getDay() : 1);
            const [selectedHall, setSelectedHall] = useState(HALLS[0].id);
            const [loading, setLoading] = useState(true);
            
            const [authModalOpen, setAuthModalOpen] = useState(false);
            const [adminLoginModalOpen, setAdminLoginModalOpen] = useState(false);
            const [bookingModal, setBookingModal] = useState({ open: false, lesson: null });
            const [messageModal, setMessageModal] = useState({ open: false, title: '', text: '' });
            const [adminCustomEventText, setAdminCustomEventText] = useState('');

            const currentWeekKey = useMemo(() => getCurrentWeekKey(), []);

            // 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
            useEffect(() => {
                const initAuth = async () => {
                    try {
                        await signInAnonymously(auth);
                    } catch (error) {
                        console.error("–ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó:", error);
                        showMessage("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firebase.");
                    }
                };

                initAuth();

                const unsubscribe = onAuthStateChanged(auth, (currentUser) => {
                    setUser(currentUser);
                    if (currentUser) {
                        const savedProfile = localStorage.getItem('rehearsal_profile');
                        if (savedProfile) {
                            setProfile(JSON.parse(savedProfile));
                        } else {
                            setAuthModalOpen(true);
                        }
                    } else {
                        setLoading(false);
                    }
                });

                return () => unsubscribe();
            }, []);

            // 2. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ Firestore
            useEffect(() => {
                if (!user) return;

                const rehearsalsRef = collection(db, COLLECTION_NAME);
                
                const unsubscribe = onSnapshot(rehearsalsRef, (snapshot) => {
                    const data = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    setRehearsals(data);
                    setLoading(false);
                }, (error) => {
                    console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:", error);
                    setLoading(false);
                });

                return () => unsubscribe();
            }, [user]);

            const saveProfile = () => {
                const classSelect = document.getElementById('class-select').value;
                const nameInput = document.getElementById('name-input').value;

                if (!nameInput.trim() || !classSelect) {
                    showMessage("–£–≤–∞–≥–∞", "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —Å–≤–æ—î —ñ–º'—è —Ç–∞ –æ–±–µ—Ä—ñ—Ç—å –∫–ª–∞—Å.");
                    return;
                }
                const newProfile = { name: nameInput.trim(), className: classSelect };
                localStorage.setItem('rehearsal_profile', JSON.stringify(newProfile));
                setProfile(newProfile);
                setAuthModalOpen(false);
            };

            const logOut = () => {
                localStorage.removeItem('rehearsal_profile');
                setProfile(null);
                setIsAdmin(false);
                localStorage.removeItem('rehearsals_admin');
                setAuthModalOpen(true);
            };

            const handleAdminLogin = () => {
                const pwd = document.getElementById('admin-pwd-input').value;
                if (pwd === ADMIN_PASSWORD) {
                    setIsAdmin(true);
                    localStorage.setItem('rehearsals_admin', 'true');
                    setAdminLoginModalOpen(false);
                    showMessage("–£—Å–ø—ñ—Ö", "–í–∏ —É–≤—ñ–π—à–ª–∏ —è–∫ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä.");
                } else {
                    showMessage("–ü–æ–º–∏–ª–∫–∞", "–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å.");
                }
            };

            const toggleAdminLogin = () => {
                if (isAdmin) {
                    setIsAdmin(false);
                    localStorage.removeItem('rehearsals_admin');
                    showMessage("–Ü–Ω—Ñ–æ", "–í–∏ –≤–∏–π—à–ª–∏ –∑ —Ä–µ–∂–∏–º—É –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.");
                } else {
                    setAdminLoginModalOpen(true);
                }
            };

            const showMessage = (title, text) => {
                setMessageModal({ open: true, title, text });
            };

            const handleSlotClick = (lessonNumber) => {
                // –Ø–∫—â–æ –Ω–µ –∞–¥–º—ñ–Ω, –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ª—ñ–º—ñ—Ç
                if (!isAdmin) {
                    const classBookingsToday = rehearsals.filter(r => 
                        r.weekKey === currentWeekKey && 
                        r.day === selectedDay && 
                        r.className === profile.className &&
                        r.danceType !== 'custom' // –Ü–≥–Ω–æ—Ä—É—î–º–æ –∞–¥–º—ñ–Ω—Å—å–∫—ñ –ø–æ–¥—ñ—ó
                    );

                    if (classBookingsToday.length >= 2) {
                        showMessage("–õ—ñ–º—ñ—Ç –≤–∏—á–µ—Ä–ø–∞–Ω–æ", `–ö–ª–∞—Å ${profile.className} –≤–∂–µ –∑–∞–±—Ä–æ–Ω—é–≤–∞–≤ –º–∞–∫—Å–∏–º—É–º (2) —Ä–µ–ø–µ—Ç–∏—Ü—ñ—ó –Ω–∞ —Ü–µ–π –¥–µ–Ω—å.`);
                        return;
                    }
                }

                setAdminCustomEventText('');
                setBookingModal({ open: true, lesson: lessonNumber });
            };

            const confirmBooking = async () => {
                if (!user || !profile || !bookingModal.lesson) return;

                let finalClassName = profile.className;
                let finalResponsibleName = profile.name;
                let finalDanceType = 'general';

                // –Ø–∫—â–æ –∞–¥–º—ñ–Ω –≤–≤—ñ–≤ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Å—Ç–∞—Ç—É—Å
                if (isAdmin && adminCustomEventText.trim() !== '') {
                    finalClassName = adminCustomEventText.trim();
                    finalResponsibleName = '–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—è';
                    finalDanceType = 'custom';
                } else {
                    const selectedTypeInput = document.querySelector('input[name="danceType"]:checked');
                    if (selectedTypeInput) {
                        finalDanceType = selectedTypeInput.value;
                    }
                }

                const newBooking = {
                    weekKey: currentWeekKey,
                    day: selectedDay,
                    lesson: bookingModal.lesson,
                    hall: selectedHall,
                    danceType: finalDanceType,
                    className: finalClassName,
                    responsibleName: finalResponsibleName,
                    uid: user.uid,
                    createdAt: Date.now()
                };

                try {
                    await addDoc(collection(db, COLLECTION_NAME), newBooking);
                    setBookingModal({ open: false, lesson: null });
                } catch (error) {
                    console.error("–ü–æ–º–∏–ª–∫–∞ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è:", error);
                    showMessage("–ü–æ–º–∏–ª–∫–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö", "–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –≤–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–ª–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö Firebase —Ç–∞ –ü—Ä–∞–≤–∏–ª–∞ (Rules).");
                }
            };

            const handleDelete = async (bookingId) => {
                try {
                    await deleteDoc(doc(db, COLLECTION_NAME, bookingId));
                } catch (error) {
                    console.error("–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è:", error);
                    showMessage("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ —Ä–µ–ø–µ—Ç–∏—Ü—ñ—é (–ú–æ–∂–ª–∏–≤–æ, –Ω–µ–º–∞—î –ø—Ä–∞–≤ —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö).");
                }
            };

            const currentViewRehearsals = rehearsals.filter(r => 
                r.weekKey === currentWeekKey && 
                r.day === selectedDay && 
                r.hall === selectedHall
            );

            if (loading) {
                return <div className="min-h-screen flex items-center justify-center text-indigo-600 font-bold text-lg">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>;
            }

            return (
                <div>
                    <header className="bg-white shadow-sm sticky top-0 z-10">
                        <div className="max-w-md mx-auto px-4 py-3 flex justify-between items-center">
                            <div>
                                <h1 className="text-xl font-bold text-indigo-600 leading-tight">–†–µ–ø–µ—Ç–∏—Ü—ñ—ó</h1>
                                <p className="text-xs text-gray-500">–¢–∏–∂–¥–µ–Ω—å: {currentWeekKey}</p>
                            </div>
                            <div className="flex items-center gap-2">
                                {/* –ö–Ω–æ–ø–∫–∞ –ê–¥–º—ñ–Ω–∞ */}
                                <button onClick={toggleAdminLogin} className={`p-2 rounded-full transition-colors ${isAdmin ? 'bg-rose-100 text-rose-600' : 'bg-gray-100 text-gray-400 hover:text-gray-600'}`}>
                                    <IconShield size={18} />
                                </button>
                                {profile && (
                                    <div className="flex items-center gap-2 bg-indigo-50 px-3 py-1.5 rounded-full border border-indigo-100 cursor-pointer" onClick={logOut}>
                                        <IconUser size={16} className="text-indigo-500" />
                                        <span className="text-sm font-medium text-indigo-700">{profile.className}</span>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="flex overflow-x-auto hide-scrollbar border-t border-gray-100 bg-white px-2 py-2 max-w-md mx-auto">
                            {DAYS.map(day => (
                                <button
                                    key={day.id}
                                    onClick={() => setSelectedDay(day.id)}
                                    className={`flex-1 min-w-[60px] mx-1 py-2 rounded-xl text-sm font-medium transition-colors ${
                                        selectedDay === day.id 
                                        ? 'bg-indigo-600 text-white shadow-md' 
                                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                    }`}
                                >
                                    {day.short}
                                </button>
                            ))}
                        </div>

                        <div className="flex p-3 gap-2 bg-gray-50 border-b border-gray-200 max-w-md mx-auto">
                            {HALLS.map(hall => (
                                <button
                                    key={hall.id}
                                    onClick={() => setSelectedHall(hall.id)}
                                    className={`flex-1 py-2.5 rounded-lg text-sm font-semibold flex items-center justify-center gap-2 transition-all ${
                                        selectedHall === hall.id
                                        ? 'bg-white text-indigo-700 border-2 border-indigo-500 shadow-sm'
                                        : 'bg-white text-gray-500 border-2 border-transparent shadow-sm'
                                    }`}
                                >
                                    <IconMapPin size={16} />
                                    {hall.name}
                                </button>
                            ))}
                        </div>
                    </header>

                    <main className="max-w-md mx-auto px-4 py-4 space-y-3">
                        {[1, 2, 3, 4, 5, 6, 7, 8, 9].map(lessonNum => {
                            const booking = currentViewRehearsals.find(r => r.lesson === lessonNum);
                            const isMyBooking = booking && user && booking.uid === user.uid;
                            const canDelete = isMyBooking || isAdmin;

                            return (
                                <div key={lessonNum} className={`p-4 rounded-2xl shadow-sm border ${booking ? 'bg-white border-gray-200' : 'bg-indigo-50/50 border-dashed border-indigo-200 hover:bg-indigo-50 cursor-pointer transition-colors'}`}
                                     onClick={() => !booking && handleSlotClick(lessonNum)}>
                                    <div className="flex justify-between items-start">
                                        <div className="flex items-center gap-3">
                                            <div className={`min-w-[32px] w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${booking ? (booking.danceType === 'custom' ? 'bg-rose-100 text-rose-600' : 'bg-gray-100 text-gray-500') : 'bg-indigo-100 text-indigo-600'}`}>
                                                {lessonNum}
                                            </div>
                                            <div>
                                                {booking ? (
                                                    <>
                                                        <h3 className={`font-bold text-lg leading-none mb-1 ${booking.danceType === 'custom' ? 'text-rose-700' : 'text-gray-800'}`}>
                                                            {booking.className}
                                                        </h3>
                                                        
                                                        {booking.danceType !== 'custom' ? (
                                                            <p className="text-xs text-gray-500 font-medium bg-gray-100 px-2 py-0.5 rounded-md inline-block mb-1">
                                                                {DANCE_TYPES.find(d => d.id === booking.danceType)?.name || '–Ü–Ω—à–µ'}
                                                            </p>
                                                        ) : (
                                                            <p className="text-xs text-rose-600 font-bold bg-rose-50 border border-rose-200 px-2 py-0.5 rounded-md inline-block mb-1">
                                                                –°–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –ø–æ–¥—ñ—è
                                                            </p>
                                                        )}
                                                        
                                                        <p className="text-sm text-gray-600 flex items-center gap-1 mt-1">
                                                            <IconUser size={12} /> {booking.responsibleName}
                                                        </p>
                                                    </>
                                                ) : (
                                                    <div className="h-8 flex items-center">
                                                        <span className="text-indigo-500 font-medium">–í—ñ–ª—å–Ω–µ –º—ñ—Å—Ü–µ</span>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                        
                                        {booking ? (
                                            canDelete && (
                                                <button 
                                                    onClick={(e) => { e.stopPropagation(); handleDelete(booking.id); }}
                                                    className="p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors"
                                                >
                                                    <IconTrash size={20} />
                                                </button>
                                            )
                                        ) : (
                                            <div className="p-2 text-indigo-400">
                                                <IconPlus size={20} />
                                            </div>
                                        )}
                                    </div>
                                </div>
                            );
                        })}
                    </main>

                    {/* –ú–æ–¥–∞–ª–∫–∏ */}
                    {authModalOpen && (
                        <div className="fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50 backdrop-blur-sm">
                            <div className="bg-white rounded-2xl p-6 w-full max-w-sm shadow-xl">
                                <h2 className="text-2xl font-bold text-gray-800 mb-2">–ü—Ä–∏–≤—ñ—Ç! üëã</h2>
                                <p className="text-sm text-gray-500 mb-6">–î–∞–≤–∞–π –ø–æ–∑–Ω–∞–π–æ–º–∏–º–æ—Å—å. –¶—ñ –¥–∞–Ω—ñ –±—É–¥—É—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—å –ø—Ä–∏ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—ñ.</p>
                                
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">–û–±–µ—Ä—ñ—Ç—å –≤–∞—à –∫–ª–∞—Å</label>
                                        <select id="class-select" className="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none bg-white">
                                            <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –∫–ª–∞—Å...</option>
                                            {CLASSES.map(c => <option key={c} value={c}>{c}</option>)}
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">–Ü–º'—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ–≥–æ</label>
                                        <input id="name-input" type="text" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –û–ª–µ–Ω–∞ –Ü–≤–∞–Ω—ñ–≤–Ω–∞" className="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none" />
                                    </div>
                                    <button onClick={saveProfile} className="w-full py-3 bg-indigo-600 text-white rounded-xl font-bold mt-4">
                                        –ó–±–µ—Ä–µ–≥—Ç–∏ —Ç–∞ –ø–æ—á–∞—Ç–∏
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* –ú–æ–¥–∞–ª–∫–∞ –≤—Ö–æ–¥—É –¥–ª—è –ê–¥–º—ñ–Ω–∞ */}
                    {adminLoginModalOpen && (
                        <div className="fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50 backdrop-blur-sm">
                            <div className="bg-white rounded-2xl p-6 w-full max-w-sm shadow-xl animate-slide-up">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                                        <IconShield className="text-rose-500" /> –í—Ö—ñ–¥ –ê–¥–º—ñ–Ω–∞
                                    </h2>
                                    <button onClick={() => setAdminLoginModalOpen(false)} className="text-gray-400 hover:text-gray-600 p-2 text-xl">‚úï</button>
                                </div>
                                <div className="space-y-4">
                                    <div>
                                        <input id="admin-pwd-input" type="password" placeholder="–ü–∞—Ä–æ–ª—å" className="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-rose-500 outline-none" />
                                    </div>
                                    <button onClick={handleAdminLogin} className="w-full py-3 bg-rose-600 text-white rounded-xl font-bold shadow-md">
                                        –£–≤—ñ–π—Ç–∏
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* –í—ñ–∫–Ω–æ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è */}
                    {bookingModal.open && (
                        <div className="fixed inset-0 bg-black/60 flex items-end sm:items-center justify-center p-0 sm:p-4 z-50 backdrop-blur-sm">
                            <div className="bg-white rounded-t-3xl sm:rounded-2xl p-6 w-full max-w-sm shadow-xl animate-slide-up max-h-[90vh] overflow-y-auto">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xl font-bold text-gray-800">–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è</h2>
                                    <button onClick={() => setBookingModal({open: false, lesson: null})} className="text-gray-400 hover:text-gray-600 p-2 text-xl">‚úï</button>
                                </div>
                                
                                <div className="mb-6 bg-gray-50 p-3 rounded-xl border border-gray-100">
                                    <p className="text-sm text-gray-600 mb-1">–î–µ—Ç–∞–ª—ñ:</p>
                                    <p className="font-medium text-gray-800">{DAYS.find(d=>d.id===selectedDay)?.name}, {bookingModal.lesson} —É—Ä–æ–∫</p>
                                    <p className="font-medium text-gray-800">{HALLS.find(h=>h.id===selectedHall)?.name} –∑–∞–ª</p>
                                </div>

                                {isAdmin && (
                                    <div className="mb-6 bg-rose-50 p-3 rounded-xl border border-rose-200">
                                        <label className="block text-sm font-bold text-rose-700 mb-2">–°—Ç–∞—Ç—É—Å –≤—ñ–¥ –ê–¥–º—ñ–Ω–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ):</label>
                                        <input 
                                            type="text" 
                                            value={adminCustomEventText}
                                            onChange={(e) => setAdminCustomEventText(e.target.value)}
                                            placeholder="–ù–∞–ø—Ä: –ó–∞–π–Ω—è—Ç–æ –¥–ª—è –∑–∞—Ö–æ–¥—É" 
                                            className="w-full p-2.5 border border-rose-300 rounded-lg focus:ring-2 focus:ring-rose-500 outline-none bg-white" 
                                        />
                                        <p className="text-xs text-rose-600 mt-2 leading-tight">–Ø–∫—â–æ –∑–∞–ø–æ–≤–Ω–∏—Ç–∏ —Ü–µ –ø–æ–ª–µ, —Ç–∏–ø —Ç–∞–Ω—Ü—é —ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è, –∞ —Ä–µ–ø–µ—Ç–∏—Ü—ñ—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏–º–µ—Ç—å—Å—è —è–∫ –°–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –ø–æ–¥—ñ—è.</p>
                                    </div>
                                )}

                                <div className={`${isAdmin && adminCustomEventText.trim() !== '' ? 'opacity-50 pointer-events-none' : ''}`}>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">–¢–∏–ø —Ç–∞–Ω—Ü—é:</label>
                                    <div className="space-y-2 mb-6">
                                        {DANCE_TYPES.map(type => (
                                            <label key={type.id} className="flex items-center p-3 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50">
                                                <input type="radio" name="danceType" value={type.id} defaultChecked={type.id === DANCE_TYPES[0].id} className="w-5 h-5 text-indigo-600" />
                                                <span className="ml-3 font-medium text-gray-700">{type.name}</span>
                                            </label>
                                        ))}
                                    </div>
                                </div>

                                <button onClick={confirmBooking} className={`w-full py-3.5 text-white rounded-xl font-bold ${isAdmin && adminCustomEventText.trim() !== '' ? 'bg-rose-600' : 'bg-indigo-600'}`}>
                                    –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ {isAdmin && adminCustomEventText.trim() !== '' ? '—Å—Ç–∞—Ç—É—Å' : '–±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è'}
                                </button>
                            </div>
                        </div>
                    )}

                    {/* –í—ñ–∫–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å */}
                    {messageModal.open && (
                        <div className="fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50 backdrop-blur-sm">
                            <div className="bg-white rounded-2xl p-6 w-full max-w-xs shadow-xl text-center">
                                <div className="w-12 h-12 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <IconInfo size={24} />
                                </div>
                                <h2 className="text-xl font-bold text-gray-800 mb-2">{messageModal.title}</h2>
                                <p className="text-gray-600 mb-6 text-sm">{messageModal.text}</p>
                                <button onClick={() => setMessageModal({open: false, title: '', text: ''})} className="w-full py-2.5 bg-gray-100 text-gray-800 font-bold rounded-xl hover:bg-gray-200">
                                    –ó—Ä–æ–∑—É–º—ñ–ª–æ
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
